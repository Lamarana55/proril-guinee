<app-spinner [filterBy]="traitementUrl" [display]="false" #editTrSpinner></app-spinner>

<form [formGroup]="traitementForm">
    <div class="row">
      <div class="col-12">
        <mat-form-field>
          <mat-label>Statut</mat-label>
          <mat-select formControlName="statusCas">
              <mat-option *ngFor="let st of statusCas$ | keyvalue" [value]="st.value">{{ st.value | statusCasFormat }}</mat-option>
          </mat-select>
          <mat-error>Le statut est obligatoire</mat-error>
        </mat-form-field>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <mat-form-field>
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description"></textarea>
        </mat-form-field>
      </div>
    </div>

    <div class="text-center">
      <button type="button" [class.spinner]="editTrSpinner.loadingEvent$ | async" mat-raised-button color="primary" 
          [disabled]="traitementForm.invalid || traitementForm.value.statusCas === oldStatut || ((editTrSpinner.loadingEvent$ | async) === true)" (click)="onSubmit()">
        Enregistrer
      </button>
    </div>
</form>
