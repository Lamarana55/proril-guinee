<div>
    <!-- Spinner -->
    <app-spinner [filterBy]="reponseUrl" [diameter]="30" #reponseSpinner></app-spinner>
  
    <div [hidden]="!dataSource || dataSource.data.length == 0">
        <div class="mat-table-header">
            <mat-form-field>
                <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Rechercher">
            </mat-form-field>
        </div>
        <div class="mat-table-container mat-elevation-z0 table-responsive-sm">
            <mat-table [dataSource]="dataSource" matSort>
            <!-- service Column -->
            <ng-container matColumnDef="service">
                <mat-header-cell *matHeaderCellDef  mat-sort-header>Services</mat-header-cell>
                <mat-cell *matCellDef="let row">{{ row.service }}</mat-cell>
            </ng-container>
            <!-- reponse Column -->
            <ng-container matColumnDef="reponse">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Réponse</mat-header-cell>
                <mat-cell *matCellDef="let row">
                    <span [ngClass]="{'badge': true, 
                                'badge-success': row.reponse === reponseType.OUI,
                                'badge-info': row.reponse === reponseType.NON}">
                                {{ row.reponse }}
                    </span>
                </mat-cell>
            </ng-container>
            <!-- description Column -->
            <ng-container matColumnDef="description">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Description</mat-header-cell>
                <mat-cell *matCellDef="let row">{{ row.description }}</mat-cell>
            </ng-container>
            <!-- Action Column -->
            <ng-container matColumnDef="action">
                <mat-header-cell *matHeaderCellDef> ACTION </mat-header-cell>
                <mat-cell  *matCellDef="let row">
                    <button *ngIf="permissions.can_edit" mat-mini-fab color="primary" (click)="onOpenModal(contentEditReponse, row.id)"
                        aria-label="Modifier" title="Modifier">
                        <mat-icon>edit</mat-icon>
                    </button>
                </mat-cell>
            </ng-container>
            <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
            </mat-table>
            <mat-paginator [pageSize]="dataSource.data.length" [pageSizeOptions]="dataSource.data.length | tableOptions"></mat-paginator>
        </div>
    </div>
    <div *ngIf="dataSource && dataSource.data.length == 0 && ((reponseSpinner.loadingEvent$ | async) === false)" class="text-info text-center mt-2">
        Aucun questionnaire trouvé !!!
    </div>
</div>

<!-- Edit reponse modal -->
<ng-template  #contentEditReponse let-c="close" let-d="dismiss">
    <div class="modal-header bg-default">
      <span class="modal-title h4 text-white">Question</span>
      <button type="button" class="close" aria-label="Close" (click)="c('Close click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        <app-edit-reponse [reponseId]="reponseId" (isDone)="onCloseModal($event)"></app-edit-reponse>
    </div>
</ng-template>
