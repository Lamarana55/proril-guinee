(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{HFeA:function(e,t,i){"use strict";i.r(t),i.d(t,"UserManagementModule",(function(){return Ot}));var n=i("ofXK"),r=i("7HIQ"),o=i("eIep"),c=i("vkgz"),a=i("2Vo4"),s=i("LRne"),u=i("q4yk"),b=i("d414"),l=i("fXoL"),d=i("tyNb"),p=i("D7GG"),m=i("bTqV"),f=i("NFeN"),h=i("8THJ"),S=i("1jcm"),v=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function g(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div"),l.Tb(1,"div",2),l.Tb(2,"div",13),l.Tb(3,"ul",14),l.Tb(4,"li",15),l.Tb(5,"div",2),l.Tb(6,"div",16),l.Jc(7,"Nom d'utilisateur"),l.Sb(),l.Tb(8,"div",17),l.Jc(9),l.Sb(),l.Sb(),l.Sb(),l.Tb(10,"li",15),l.Tb(11,"div",2),l.Tb(12,"div",16),l.Jc(13,"Nom"),l.Sb(),l.Tb(14,"div",18),l.Jc(15),l.Sb(),l.Sb(),l.Sb(),l.Tb(16,"li",15),l.Tb(17,"div",2),l.Tb(18,"div",16),l.Jc(19,"Prenom"),l.Sb(),l.Tb(20,"div",18),l.Jc(21),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(22,"div",13),l.Tb(23,"ul",14),l.Tb(24,"li",15),l.Tb(25,"div",2),l.Tb(26,"div",16),l.Jc(27,"Email"),l.Sb(),l.Tb(28,"div",18),l.Jc(29),l.Sb(),l.Sb(),l.Sb(),l.Tb(30,"li",15),l.Tb(31,"div",2),l.Tb(32,"div",16),l.Jc(33,"Telephone"),l.Sb(),l.Tb(34,"div",18),l.Jc(35),l.Sb(),l.Sb(),l.Sb(),l.Tb(36,"li",15),l.Tb(37,"div",2),l.Tb(38,"div",16),l.Jc(39,"Statut"),l.Sb(),l.Tb(40,"div",18),l.Tb(41,"mat-slide-toggle",19),l.ec("change",(function(){l.zc(i);var e=t.ngIf;return l.ic().onChangeStatus(e.id)})),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb()}if(2&e){var n=t.ngIf;l.Ab(9),l.Kc(n.username),l.Ab(6),l.Kc(n.nom),l.Ab(6),l.Kc(n.prenom),l.Ab(8),l.Kc(n.email),l.Ab(6),l.Kc(n.telephone),l.Ab(6),l.pc("checked","Activated"===n.statut)}}function T(e,t){1&e&&(l.Tb(0,"h2"),l.Jc(1,"Localit\xe9"),l.Sb())}function y(e,t){if(1&e&&(l.Tb(0,"li",15),l.Tb(1,"div",2),l.Tb(2,"div",16),l.Jc(3,"Region"),l.Sb(),l.Tb(4,"div",18),l.Jc(5),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(5),l.Kc(i.nom)}}function A(e,t){if(1&e&&(l.Tb(0,"li",15),l.Tb(1,"div",2),l.Tb(2,"div",16),l.Jc(3,"Prefecture"),l.Sb(),l.Tb(4,"div",18),l.Jc(5),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(5),l.Kc(i.nom)}}function w(e,t){if(1&e&&(l.Tb(0,"li",15),l.Tb(1,"div",2),l.Tb(2,"div",16),l.Jc(3,"Sous-Prefecture/Commune"),l.Sb(),l.Tb(4,"div",18),l.Jc(5),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(5),l.Kc(i.nom)}}function k(e,t){if(1&e&&(l.Tb(0,"li",15),l.Tb(1,"div",2),l.Tb(2,"div",16),l.Jc(3,"Quartier"),l.Sb(),l.Tb(4,"div",18),l.Jc(5),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(5),l.Kc(i.nom)}}function I(e,t){if(1&e&&(l.Tb(0,"li",15),l.Tb(1,"div",2),l.Tb(2,"div",16),l.Jc(3,"Secteur"),l.Sb(),l.Tb(4,"div",18),l.Jc(5),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(5),l.Kc(i.nom)}}function J(e,t){if(1&e&&(l.Tb(0,"div",20),l.Hc(1,T,2,0,"h2",10),l.Tb(2,"div",2),l.Tb(3,"div",16),l.Tb(4,"ul",14),l.Hc(5,y,6,1,"li",21),l.Hc(6,A,6,1,"li",21),l.Hc(7,w,6,1,"li",21),l.Sb(),l.Sb(),l.Tb(8,"div",16),l.Tb(9,"ul",14),l.Hc(10,k,6,1,"li",21),l.Hc(11,I,6,1,"li",21),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(1),l.pc("ngIf",i.region),l.Ab(4),l.pc("ngIf",i.region),l.Ab(1),l.pc("ngIf",i.prefecture),l.Ab(1),l.pc("ngIf",i.commune),l.Ab(3),l.pc("ngIf",i.quartier),l.Ab(1),l.pc("ngIf",i.secteur)}}function O(e,t){if(1&e&&(l.Tb(0,"button",24),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("title",i.description||""),l.Ab(1),l.Kc(i.libelle)}}function N(e,t){if(1&e&&(l.Tb(0,"div",20),l.Tb(1,"div",2),l.Tb(2,"div",16),l.Tb(3,"fieldset",22),l.Tb(4,"legend",22),l.Jc(5),l.Sb(),l.Hc(6,O,2,2,"button",23),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e){var i=l.ic();l.Ab(5),l.Kc(i.role.nom),l.Ab(1),l.pc("ngForOf",i.role.permissions)}}var C=function(e){return{id:e}},x=function(e){return["/users/edit",e]},R=function(){function e(e,t,i,n){this.route=e,this.userService=t,this.utils=i,this.router=n,this.subject=new a.a(0),this.returnUrl="../..",this.userUrl=r.b}return e.prototype.ngOnInit=function(){var e=this;this.urlSubscription=this.utils.previousUrl$.subscribe((function(t){e.returnUrl=t||e.returnUrl})),this.userId=this.route.snapshot.params.id,this.user$=isNaN(this.userId)?Object(s.a)(new u.a).pipe(Object(c.a)((function(){e.router.navigate([e.returnUrl])}))):this.subject.asObservable().pipe(Object(o.a)((function(){return e.userService.getOne(e.userId).pipe(Object(c.a)((function(t){e.role=t.role})))})))},e.prototype.onChangeStatus=function(e){var t=this;this.userService.changeStatus(e).subscribe((function(){return t.subject.next(0)}))},e.prototype.onDelete=function(e){var t=this;this.userService.delete(e).subscribe((function(){t.utils.showNotif("Utilisateur supprim\xe9 avec succ\xe8s","success"),t.router.navigate([t.returnUrl])}),(function(e){t.utils.showNotif("Une erreur est survenue lors de l'operation "+e,"danger")}))},e.prototype.ngOnDestroy=function(){this.urlSubscription&&this.urlSubscription.unsubscribe()},e.\u0275fac=function(t){return new(t||e)(l.Nb(d.a),l.Nb(r.c),l.Nb(p.a),l.Nb(d.e))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-single-user"]],decls:23,vars:14,consts:[[1,"card"],[1,"card-header","bg-default"],[1,"row"],[1,"col-sm-8","form-inline"],["mat-mini-fab","","color","info",3,"routerLink"],[1,"card-title","ml-1","text-white"],[1,"col-sm-4","text-right"],["mat-mini-fab","","color","warn",3,"click"],[1,"card-body"],[3,"filterBy"],[4,"ngIf"],["class","card card-body ",4,"ngIf"],["class","card card-body",4,"ngIf"],[1,"col-md-6"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"col"],[1,"col","font-weight-bold","font-italic"],[1,"col","font-weight-bold"],["color","primary",3,"checked","change"],[1,"card","card-body"],["class","list-group-item",4,"ngIf"],[1,"fieldset-border"],["mat-button","","color","info-default",3,"title",4,"ngFor","ngForOf"],["mat-button","","color","info-default",3,"title"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"button",4),l.Tb(5,"mat-icon"),l.Jc(6,"reply"),l.Sb(),l.Sb(),l.Tb(7,"h2",5),l.Jc(8," Utilisateur "),l.Sb(),l.Sb(),l.Tb(9,"div",6),l.Tb(10,"button",4),l.Tb(11,"mat-icon"),l.Jc(12,"edit"),l.Sb(),l.Sb(),l.Tb(13,"button",7),l.ec("click",(function(){return t.onDelete(t.userId)})),l.Tb(14,"mat-icon"),l.Jc(15,"delete"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(16,"div",8),l.Ob(17,"app-spinner",9),l.Hc(18,g,42,6,"div",10),l.jc(19,"async"),l.Sb(),l.Sb(),l.Hc(20,J,12,6,"div",11),l.jc(21,"async"),l.Hc(22,N,7,2,"div",12)),2&e&&(l.Ab(4),l.pc("routerLink",t.returnUrl),l.Ab(6),l.pc("routerLink",l.tc(12,x,l.tc(10,C,t.userId))),l.Ab(7),l.pc("filterBy",t.userUrl),l.Ab(1),l.pc("ngIf",l.kc(19,6,t.user$)),l.Ab(2),l.pc("ngIf",l.kc(21,8,t.user$)),l.Ab(2),l.pc("ngIf",t.role))},directives:[m.a,d.f,f.a,h.a,n.m,S.a,n.l],pipes:[n.b],styles:[""]}),function(e,t,i,n){var r,o=arguments.length,c=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(o<3?r(c):o>3?r(t,i,c):r(t,i))||c);o>3&&c&&Object.defineProperty(t,i,c)}([Object(b.a)({html:"Voulez-vous supprimer cet utilisateur ?",icon:"warning"}),v("design:type",Function),v("design:paramtypes",[Number]),v("design:returntype",void 0)],e.prototype,"onDelete",null),e}(),F=i("3Pt+"),L=i("6vGg"),P=i("dNgK"),_=i("kmnG"),E=i("qFsG"),j=i("bSwM"),H=i("Qu3c"),M=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function c(e){try{s(n.next(e))}catch(t){o(t)}}function a(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(c,a)}s((n=n.apply(e,t||[])).next())}))},U=function(e,t){var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,n=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(a){o=[6,a],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function D(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div",18),l.Tb(1,"mat-checkbox",19),l.ec("ngModelChange",(function(e){l.zc(i);var n=t.index;return l.ic().permissionForms[n].value=e})),l.Jc(2),l.Sb(),l.Ob(3,"hr"),l.Sb()}if(2&e){var n=t.$implicit,r=t.index,o=l.ic();l.Ab(1),l.pc("disabled",n.disable)("ngModel",o.permissionForms[r].value)("matTooltip",n.permission.description),l.Ab(1),l.Kc(n.permission.libelle)}}var z=function(){function e(e,t,i,n,o,c){this.fb=e,this.userService=t,this.route=i,this.snackBar=n,this.router=o,this.utils=c,this.isNew=!0,this.permissionForms=new Array,this.roleId=0,this.roleUrl=r.a}return e.prototype.ngOnInit=function(){this.roleId=this.route.snapshot.params.id,this.isNew=isNaN(this.roleId),this.initPermissions(),this.initForm(),this.isNew||this.mapRole()},e.prototype.initForm=function(){this.roleForm=this.fb.group({nom:["",[F.u.required,F.u.minLength(3)]],description:""})},e.prototype.resetForm=function(){this.initForm(),this.roleForm.markAsUntouched(),this.roleForm.markAsPristine(),this.roleForm.updateValueAndValidity(),this.initPermissions()},e.prototype.onSubmit=function(){var e=this;if(this.roleForm.invalid){var t=this.roleForm.controls;Object.keys(t).forEach((function(e){return t[e].markAsTouched()}))}else{var i=this.roleForm.value;i.permissions=this.permissionForms.filter((function(e){return!0===e.value})).map((function(e){return e.permission})),0!==i.permissions.length?(this.isNew?this.userService.addRole(i):this.userService.updateRole(this.roleId,i)).subscribe((function(){e.utils.showNotif("Operation effectu\xe9e avec succ\xe8s","success"),e.isNew?e.resetForm():e.router.navigate(["users/roles"])}),(function(t){e.utils.showNotif("Une erreur est survenue lors de l'op\xe9ration \n "+t,"danger")})):this.snackBar.open("Impossible d'ajouter un role sans permission","",{duration:3e3,verticalPosition:"top",panelClass:["my-snack-warning"]})}},e.prototype.mapRole=function(){return M(this,void 0,void 0,(function(){var e,t=this;return U(this,(function(i){switch(i.label){case 0:return[4,this.userService.getOneRole(this.roleId).toPromise()];case 1:return e=i.sent(),this.roleForm.patchValue({nom:e.nom,description:e.description}),this.initPermissions().then((function(){t.permissionForms=t.permissionForms.map((function(t){return{permission:t.permission,value:e.permissions.some((function(e){return e.id===t.permission.id})),disable:t.disable}}))})),[2]}}))}))},e.prototype.initPermissions=function(){return M(this,void 0,void 0,(function(){var e;return U(this,(function(t){switch(t.label){case 0:return[4,this.userService.getAllPermission().toPromise()];case 1:return e=t.sent(),this.permissionForms=e.map((function(e){var t=!1,i=!1;return e.libelle===L.c.CAN_VIEW_DASHBORD&&(t=!0,i=!0),{permission:e,value:t,disable:i}})),[2]}}))}))},e.\u0275fac=function(t){return new(t||e)(l.Nb(F.c),l.Nb(r.c),l.Nb(d.a),l.Nb(P.a),l.Nb(d.e),l.Nb(p.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-edit-role"]],decls:38,vars:8,consts:[[1,"card"],[1,"card-header","bg-default"],[1,"row"],[1,"col-sm-12","form-inline"],["mat-mini-fab","","color","info","routerLink",".."],[1,"card-title","ml-1","text-white"],[1,"card-body"],[3,"filterBy","diameter"],["roleSpinner",""],[1,"col-md-8","offset-md-2","col-sm-12"],[3,"formGroup"],[1,"col-12"],["matInput","","type","text","formControlName","nom","placeholder","Saisissez le nom du role"],["matInput","","formControlName","description","placeholder","Faites une description du role"],[1,"fieldset-border"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"text-center","mt-2"],["type","button","mat-raised-button","","color","primary",3,"disabled","click"],[1,"col-md-4"],[3,"disabled","ngModel","matTooltip","ngModelChange"]],template:function(e,t){if(1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"button",4),l.Tb(5,"mat-icon"),l.Jc(6,"reply"),l.Sb(),l.Sb(),l.Tb(7,"h2",5),l.Jc(8),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(9,"div",6),l.Ob(10,"app-spinner",7,8),l.Tb(12,"div",2),l.Tb(13,"div",9),l.Tb(14,"form",10),l.Tb(15,"div",2),l.Tb(16,"div",11),l.Tb(17,"mat-form-field"),l.Tb(18,"mat-label"),l.Jc(19,"Nom"),l.Sb(),l.Ob(20,"input",12),l.Tb(21,"mat-error"),l.Jc(22,"Nom incorrect"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(23,"div",2),l.Tb(24,"div",11),l.Tb(25,"mat-form-field"),l.Tb(26,"mat-label"),l.Jc(27,"Description"),l.Sb(),l.Ob(28,"textarea",13),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(29,"fieldset",14),l.Tb(30,"legend",14),l.Jc(31,"Permissions"),l.Sb(),l.Tb(32,"div",2),l.Hc(33,D,4,4,"div",15),l.Sb(),l.Sb(),l.Tb(34,"div",16),l.Tb(35,"button",17),l.ec("click",(function(){return t.onSubmit()})),l.jc(36,"async"),l.Jc(37,"Enregistrer"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e){var i=l.xc(11);l.Ab(8),l.Lc(" ",t.isNew?"Enregistrement d'un role":"Modification d'un role"," "),l.Ab(2),l.pc("filterBy",t.roleUrl)("diameter",30),l.Ab(4),l.pc("formGroup",t.roleForm),l.Ab(19),l.pc("ngForOf",t.permissionForms),l.Ab(2),l.pc("disabled",l.kc(36,6,i.loadingEvent$))}},directives:[m.a,d.f,f.a,h.a,F.w,F.m,F.e,_.c,_.f,E.a,F.b,F.l,F.d,_.b,n.l,j.a,F.o,H.a],pipes:[n.b],styles:[".mat-form-field[_ngcontent-%COMP%]{font-size:17px;width:100%}"]}),e}(),q=i("9qFf"),K=i("1kSV"),Q=function(){function e(){}return e.prototype.transform=function(e){switch(e){case L.d.ROLE_ADMIN:return"Administrateur";case L.d.ROLE_ASSISTANT_ADMIN:return"Assistant Administrateur";case L.d.ROLE_CONSULTANT:return"Consultant";case L.d.ROLE_GROSSISTE:return"Grossiste";default:return""}},e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=l.Mb({name:"roleNameFormat",type:e,pure:!0}),e}(),V=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function G(e,t){1&e&&(l.Tb(0,"button",12),l.Tb(1,"mat-icon"),l.Jc(2,"add"),l.Sb(),l.Sb())}function B(e,t){1&e&&(l.Tb(0,"th"),l.Jc(1,"OPTIONS"),l.Sb())}function W(e,t){if(1&e&&(l.Tb(0,"li",35),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.Ab(1),l.Lc(" ",i.libelle," ")}}function X(e,t){if(1&e&&(l.Tb(0,"div",32),l.Tb(1,"ul",33),l.Hc(2,W,2,1,"li",34),l.Sb(),l.Sb()),2&e){var i=l.ic().$implicit;l.Ab(2),l.pc("ngForOf",i.permissions)}}var Y=function(e){return{id:e}},Z=function(e){return["edit",e]};function ee(e,t){if(1&e&&(l.Tb(0,"button",38),l.Tb(1,"mat-icon"),l.Jc(2,"edit"),l.Sb(),l.Sb()),2&e){var i=l.ic(2).$implicit;l.pc("routerLink",l.tc(3,Z,l.tc(1,Y,i.id)))}}function te(e,t){if(1&e){var i=l.Ub();l.Tb(0,"button",39),l.ec("click",(function(){l.zc(i);var e=l.ic(2).$implicit;return l.ic(3).onDelete(e.id)})),l.Tb(1,"mat-icon"),l.Jc(2,"delete"),l.Sb(),l.Sb()}}function ie(e,t){if(1&e&&(l.Tb(0,"td"),l.Hc(1,ee,3,5,"button",36),l.Hc(2,te,3,0,"button",37),l.Sb()),2&e){var i=l.ic(4);l.Ab(1),l.pc("ngIf",i.permissions.can_edit),l.Ab(1),l.pc("ngIf",i.permissions.can_delete)}}function ne(e,t){if(1&e&&(l.Tb(0,"tr"),l.Tb(1,"th",29),l.Jc(2),l.Sb(),l.Tb(3,"td"),l.Jc(4),l.jc(5,"roleNameFormat"),l.Sb(),l.Tb(6,"td"),l.Jc(7),l.Sb(),l.Tb(8,"td"),l.Tb(9,"button",30),l.Tb(10,"mat-icon"),l.Jc(11,"visibility"),l.Sb(),l.Sb(),l.Hc(12,X,3,1,"ng-template",null,31,l.Ic),l.Sb(),l.Hc(14,ie,3,2,"td",11),l.Sb()),2&e){var i=t.$implicit,n=t.index,r=l.xc(13),o=l.ic(3);l.Ab(2),l.Kc((o.page-1)*o.pageSize+1+n),l.Ab(2),l.Kc(l.lc(5,5,i.nom,i.nom)),l.Ab(3),l.Kc(i.description),l.Ab(2),l.pc("ngbPopover",r),l.Ab(5),l.pc("ngIf",o.permissions.can_edit||o.permissions.can_delete)}}function re(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div"),l.Tb(1,"div",2),l.Tb(2,"div",15),l.Tb(3,"label",16),l.Jc(4,"Taille"),l.Sb(),l.Tb(5,"select",17),l.ec("ngModelChange",(function(e){return l.zc(i),l.ic(2).pageSize=e})),l.Tb(6,"option",18),l.Jc(7,"5"),l.Sb(),l.Tb(8,"option",19),l.Jc(9,"10"),l.Sb(),l.Tb(10,"option",20),l.Jc(11,"50"),l.Sb(),l.Tb(12,"option",21),l.Jc(13,"100"),l.Sb(),l.Tb(14,"option",22),l.Jc(15,"Tout"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(16,"div",23),l.Tb(17,"table",24),l.Tb(18,"thead",25),l.Tb(19,"th"),l.Jc(20,"#"),l.Sb(),l.Tb(21,"th"),l.Jc(22,"ROLES"),l.Sb(),l.Tb(23,"th"),l.Jc(24,"DESCRIPTION"),l.Sb(),l.Tb(25,"th",26),l.Jc(26,"PERMISSIONS"),l.Sb(),l.Hc(27,B,2,0,"th",11),l.Sb(),l.Tb(28,"tbody",25),l.Hc(29,ne,15,8,"tr",27),l.jc(30,"slice"),l.Sb(),l.Sb(),l.Sb(),l.Tb(31,"ngb-pagination",28),l.ec("pageChange",(function(e){return l.zc(i),l.ic(2).page=e})),l.Sb(),l.Sb()}if(2&e){var n=l.ic().ngIf,r=l.ic();l.Ab(5),l.pc("ngModel",r.pageSize),l.Ab(9),l.pc("value",n.length),l.Ab(13),l.pc("ngIf",r.permissions.can_edit||r.permissions.can_delete),l.Ab(2),l.pc("ngForOf",l.mc(30,11,n,(r.page-1)*r.pageSize,(r.page-1)*r.pageSize+r.pageSize)),l.Ab(2),l.pc("page",r.page)("pageSize",r.pageSize)("collectionSize",n.length)("rotate",!0)("ellipses",!1)("boundaryLinks",!0)("maxSize",5)}}function oe(e,t){1&e&&(l.Tb(0,"div",40),l.Jc(1," Aucun role trouv\xe9 !!! "),l.Sb())}function ce(e,t){if(1&e&&(l.Tb(0,"div"),l.Hc(1,re,32,15,"div",13),l.Hc(2,oe,2,0,"ng-template",null,14,l.Ic),l.Sb()),2&e){var i=t.ngIf,n=l.xc(3);l.Ab(1),l.pc("ngIf",i.length>0)("ngIfElse",n)}}var ae=function(){function e(e,t,i){this.userService=e,this.auth=t,this.utils=i,this.subject=new a.a(0),this.page=1,this.pageSize=5,this.permissions={can_add:!1,can_edit:!1,can_delete:!1},this.roleUrl=r.a}return e.prototype.ngOnInit=function(){var e=this;this.setPermissions(),this.roles$=this.subject.asObservable().pipe(Object(o.a)((function(){return e.userService.getAllRoles()})))},e.prototype.onRefresh=function(){this.subject.next(0)},e.prototype.onDelete=function(e){var t=this;this.userService.deleteRole(e).subscribe((function(){t.utils.showNotif("Role supprim\xe9 avec succ\xe8s","success"),t.onRefresh()}),(function(e){t.utils.showNotif("Une erreur est survenue lors de l'operation "+e,"danger")}))},e.prototype.ngAfterViewInit=function(){$((function(){$('[data-toggle="popover"]').popover()}))},e.prototype.setPermissions=function(){var e=this.auth.getPermissions();this.permissions={can_add:e.includes(L.c.CAN_ADD_ROLE),can_edit:e.includes(L.c.CAN_UPDATE_ROLE),can_delete:e.includes(L.c.CAN_DELETE_ROLE)}},e.\u0275fac=function(t){return new(t||e)(l.Nb(r.c),l.Nb(q.a),l.Nb(p.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-list-role"]],decls:16,vars:5,consts:[[1,"card"],[1,"card-header","bg-default"],[1,"row"],[1,"col-sm-8"],[1,"card-title","text-white"],[1,"nc-icon","nc-single-02"],[1,"col-sm-4","text-right","mt-2"],["mat-raised-button","","routerLink","edit","class","mr-1","color","info",4,"ngIf"],["mat-raised-button","","color","info",3,"click"],[1,"card-body"],[3,"filterBy"],[4,"ngIf"],["mat-raised-button","","routerLink","edit","color","info",1,"mr-1"],[4,"ngIf","ngIfElse"],["noData",""],[1,"col-md-2","col-sm-6","mb-3"],["for","taille",1,"col-form-label"],["id","taille","name","taille",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","50"],["value","100"],[3,"value"],[1,"table-responsive","mb-2"],[1,"table","table-striped","table-bordered"],[1,"text-center"],[2,"width","20px"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center",3,"page","pageSize","collectionSize","rotate","ellipses","boundaryLinks","maxSize","pageChange"],["scope","row"],["mat-mini-fab","","color","info","container","body","placement","left","popoverTitle","Permissions",3,"ngbPopover"],["permissionsMessage",""],[1,"permissions"],[1,"list-group","list-group","flush"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],["mat-mini-fab","","color","info",3,"routerLink",4,"ngIf"],["mat-mini-fab","","color","accent",3,"click",4,"ngIf"],["mat-mini-fab","","color","info",3,"routerLink"],["mat-mini-fab","","color","accent",3,"click"],[1,"text-center","text-info"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"h2",4),l.Ob(5,"i",5),l.Jc(6," Liste des roles "),l.Sb(),l.Sb(),l.Tb(7,"div",6),l.Hc(8,G,3,0,"button",7),l.Tb(9,"button",8),l.ec("click",(function(){return t.onRefresh()})),l.Tb(10,"mat-icon"),l.Jc(11,"refresh"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(12,"div",9),l.Ob(13,"app-spinner",10),l.Hc(14,ce,4,2,"div",11),l.jc(15,"async"),l.Sb(),l.Sb()),2&e&&(l.Ab(8),l.pc("ngIf",t.permissions.can_add),l.Ab(5),l.pc("filterBy",t.roleUrl),l.Ab(1),l.pc("ngIf",l.kc(15,3,t.roles$)))},directives:[n.m,m.a,f.a,h.a,d.f,F.t,F.l,F.o,F.p,F.v,n.l,K.c,K.d],pipes:[n.b,n.u,Q],styles:[".permissions[_ngcontent-%COMP%]{height:200px;overflow-y:auto;width:200px}"]}),function(e,t,i,n){var r,o=arguments.length,c=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(o<3?r(c):o>3?r(t,i,c):r(t,i))||c);o>3&&c&&Object.defineProperty(t,i,c)}([Object(b.a)({html:"Voulez-vous supprimer ce role ? <br>Les utilisateur ayant ce role auront un role par defaut",icon:"warning"}),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",void 0)],e.prototype,"onDelete",null),e}(),se=i("7rb6"),ue=i("d3UM"),be=i("FKr1"),le=i("BZeA"),de=i("+H3C"),pe=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function c(e){try{s(n.next(e))}catch(t){o(t)}}function a(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(c,a)}s((n=n.apply(e,t||[])).next())}))},me=function(e,t){var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,n=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(a){o=[6,a],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function fe(e,t){if(1&e&&(l.Tb(0,"div",9),l.Tb(1,"div",10),l.Tb(2,"div",4),l.Tb(3,"div",11),l.Jc(4,"Region "),l.Sb(),l.Tb(5,"div",12),l.Jc(6),l.Sb(),l.Sb(),l.Tb(7,"div",4),l.Tb(8,"div",11),l.Jc(9,"Prefecture"),l.Sb(),l.Tb(10,"div",12),l.Jc(11),l.Sb(),l.Sb(),l.Tb(12,"div",4),l.Tb(13,"div",11),l.Jc(14,"Commune/Sous-prefecture"),l.Sb(),l.Tb(15,"div",12),l.Jc(16),l.Sb(),l.Sb(),l.Tb(17,"div",4),l.Tb(18,"div",11),l.Jc(19,"Quartier"),l.Sb(),l.Tb(20,"div",12),l.Jc(21),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e){var i=t.ngIf;l.Ab(6),l.Kc(i.commune.prefecture.region.nom),l.Ab(5),l.Kc(i.commune.prefecture.nom),l.Ab(5),l.Kc(i.commune.nom),l.Ab(5),l.Kc(i.nom)}}var he=function(){function e(e,t,i){this.fb=e,this.localiteService=t,this.snackBar=i,this.isNew=!0,this.secteurId=0,this.isDone=new l.o,this.subjectQuartier=new a.a(0)}return e.prototype.ngOnInit=function(){var e=this;this.quartier$=this.subjectQuartier.asObservable().pipe(Object(o.a)((function(t){return 0===t?Object(s.a)(new de.a):e.localiteService.getOneQuartier(t)}))),this.initForm()},e.prototype.onSubmit=function(){return pe(this,void 0,void 0,(function(){var e,t,i=this;return me(this,(function(n){switch(n.label){case 0:return this.secteurForm.invalid?[3,2]:(t=e=this.secteurForm.value,[4,this.localiteService.getOneQuartier(this.quartierId).toPromise()]);case 1:t.quartier=n.sent(),this.isNew?this.localiteService.addSecteur(e).subscribe((function(e){i.snackBar.open("Enregistr\xe9 avec succ\xe8s","Enregistrement",{duration:5e3,verticalPosition:"top",panelClass:["my-snack-success"]}),i.resetForm(),i.isDone.emit({done:!0,id:e.id})}),(function(e){i.snackBar.open("Une erreur est survenue lors de l'enregistrement "+e,"Enregistrement",{duration:5e3,verticalPosition:"top",panelClass:["my-snack-warning"]})})):(e.id=this.secteurId,this.localiteService.updateSecteur(e).subscribe((function(e){i.snackBar.open("Modifi\xe9 avec succ\xe8s","Modification",{duration:5e3,verticalPosition:"top",panelClass:["my-snack-success"]}),i.resetForm(),i.isDone.emit({done:!0,id:e.id})}),(function(e){i.snackBar.open("Une erreur est survenue lors de la modificationv"+e,"Modification",{duration:5e3,verticalPosition:"top",panelClass:["my-snack-warning"]})}))),n.label=2;case 2:return[2]}}))}))},e.prototype.initForm=function(){this.secteurForm=this.fb.group({nom:["",F.u.required],description:""})},e.prototype.resetForm=function(){this.initForm(),this.secteurForm.markAsPristine(),this.secteurForm.markAsUntouched(),this.secteurForm.updateValueAndValidity()},e.prototype.ngOnChanges=function(e){e.quartierId.previousValue!==e.quartierId.currentValue&&this.subjectQuartier.next(this.quartierId),!e.isNew.currentValue&&e.secteurId.currentValue>0&&this.mapSecteur()},e.prototype.mapSecteur=function(){return pe(this,void 0,void 0,(function(){var e;return me(this,(function(t){switch(t.label){case 0:return[4,this.localiteService.getOneSecteur(this.secteurId).toPromise()];case 1:return e=t.sent(),this.secteurForm.patchValue({nom:e.nom,description:e.description}),[2]}}))}))},e.\u0275fac=function(t){return new(t||e)(l.Nb(F.c),l.Nb(se.a),l.Nb(P.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-secteur"]],inputs:{isNew:"isNew",secteurId:"secteurId",quartierId:"quartierId"},outputs:{isDone:"isDone"},features:[l.yb],decls:24,vars:6,consts:[[1,"text-center"],[1,"card-title"],["class","card-body",4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-12"],["type","text","matInput","","formControlName","nom"],["matInput","","formControlName","description"],["type","button","mat-raised-button","","color","primary",3,"disabled","click"],[1,"card-body"],[2,"font-size","15px"],[1,"col-6"],[1,"col-6","font-weight-bold"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"h2",1),l.Jc(2),l.Sb(),l.Sb(),l.Hc(3,fe,22,4,"div",2),l.jc(4,"async"),l.Tb(5,"div"),l.Tb(6,"form",3),l.Tb(7,"div",4),l.Tb(8,"div",5),l.Tb(9,"mat-form-field"),l.Tb(10,"mat-label"),l.Jc(11,"Nom"),l.Sb(),l.Ob(12,"input",6),l.Tb(13,"mat-error"),l.Jc(14,"Le nom est obligatoire"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(15,"div",4),l.Tb(16,"div",5),l.Tb(17,"mat-form-field"),l.Tb(18,"mat-label"),l.Jc(19,"Description"),l.Sb(),l.Ob(20,"textarea",7),l.Sb(),l.Sb(),l.Sb(),l.Tb(21,"div",0),l.Tb(22,"button",8),l.ec("click",(function(){return t.onSubmit()})),l.Jc(23," Enregistrer "),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e&&(l.Ab(2),l.Kc(t.isNew?"Enregistrement":"Modification"),l.Ab(1),l.pc("ngIf",l.kc(4,4,t.quartier$)),l.Ab(3),l.pc("formGroup",t.secteurForm),l.Ab(16),l.pc("disabled",t.secteurForm.invalid))},directives:[n.m,F.w,F.m,F.e,_.c,_.f,E.a,F.b,F.l,F.d,_.b,m.a],pipes:[n.b],styles:[".mat-form-field[_ngcontent-%COMP%]{font-size:17px;width:100%}"]}),e}(),Se=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function c(e){try{s(n.next(e))}catch(t){o(t)}}function a(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(c,a)}s((n=n.apply(e,t||[])).next())}))},ve=function(e,t){var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,n=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(a){o=[6,a],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function ge(e,t){if(1&e&&(l.Tb(0,"mat-option",32),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function Te(e,t){if(1&e&&(l.Tb(0,"mat-option",32),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function ye(e,t){if(1&e&&(l.Tb(0,"mat-option",32),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function Ae(e,t){if(1&e&&(l.Tb(0,"mat-option",32),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function we(e,t){if(1&e&&(l.Tb(0,"mat-option",32),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function ke(e,t){if(1&e&&(l.Tb(0,"mat-option",32),l.Jc(1),l.jc(2,"roleNameFormat"),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(l.lc(2,2,i.nom,i.nom))}}function Ie(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div",33),l.Tb(1,"h4",34),l.Jc(2,"Quartier"),l.Sb(),l.Tb(3,"button",35),l.ec("click",(function(){return(0,t.close)("Close click")})),l.Tb(4,"span",36),l.Jc(5,"\xd7"),l.Sb(),l.Sb(),l.Sb(),l.Tb(6,"div",37),l.Tb(7,"app-quartier",38),l.ec("isDone",(function(e){return l.zc(i),l.ic().onNewQuartier(e)})),l.Sb(),l.Sb()}if(2&e){var n=l.ic();l.Ab(7),l.pc("isNew",!0)("communeId",n.communeId)}}function Je(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div",33),l.Tb(1,"h4",34),l.Jc(2,"Secteur"),l.Sb(),l.Tb(3,"button",35),l.ec("click",(function(){return(0,t.close)("Close click")})),l.Tb(4,"span",36),l.Jc(5,"\xd7"),l.Sb(),l.Sb(),l.Sb(),l.Tb(6,"div",37),l.Tb(7,"app-secteur",39),l.ec("isDone",(function(e){return l.zc(i),l.ic().onNewSecteur(e)})),l.Sb(),l.Sb()}if(2&e){var n=l.ic();l.Ab(7),l.pc("isNew",!0)("quartierId",n.quartierId)}}var Oe=function(){function e(e,t,i,n,o,c,a,s){this.fb=e,this.route=t,this.router=i,this.userService=n,this.localiteService=o,this.utils=c,this.snackBar=a,this.modalService=s,this.isNew=!0,this.userId=0,this.userUrl=r.b}return e.prototype.ngOnInit=function(){this.userId=this.route.snapshot.params.id,this.isNew=isNaN(this.userId),this.roles$=this.userService.getAllRoles(),this.initForm(),this.onEdit(),this.loadInfos(),this.onChangeSelectLocalite()},e.prototype.initForm=function(){this.userForm=this.fb.group({nom:["",[F.u.required,F.u.minLength(2)]],prenom:["",[F.u.required,F.u.minLength(2)]],email:["",[F.u.required,F.u.email]],region:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),prefecture:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),commune:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),quartier:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),secteur:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),telephone:["",[F.u.required,F.u.pattern(L.h)]],role:this.fb.group({id:[null,[F.u.required,F.u.pattern(L.e)]]})})},e.prototype.resetForm=function(){this.initForm(),this.userForm.markAsPristine(),this.userForm.markAsUntouched(),this.userForm.updateValueAndValidity()},e.prototype.onSubmit=function(){return Se(this,void 0,void 0,(function(){var e,t,i,n,r,o,c,a,s,u,b,l,d=this;return ve(this,(function(p){switch(p.label){case 0:return this.userForm.invalid?[3,17]:(t=e=this.userForm.value,[4,this.userService.getOneRole(e.role.id).toPromise()]);case 1:return t.role=p.sent(),i=e,e.region?[4,this.localiteService.getOneRegion(e.region.id).toPromise()]:[3,3];case 2:return n=p.sent(),[3,4];case 3:n=null,p.label=4;case 4:return i.region=n,r=e,e.prefecture?[4,this.localiteService.getOnePrefecture(e.prefecture.id).toPromise()]:[3,6];case 5:return o=p.sent(),[3,7];case 6:o=null,p.label=7;case 7:return r.prefecture=o,c=e,e.commune?[4,this.localiteService.getOnecommune(e.commune.id).toPromise()]:[3,9];case 8:return a=p.sent(),[3,10];case 9:a=null,p.label=10;case 10:return c.commune=a,s=e,e.quartier?[4,this.localiteService.getOneQuartier(e.quartier.id).toPromise()]:[3,12];case 11:return u=p.sent(),[3,13];case 12:u=null,p.label=13;case 13:return s.quartier=u,b=e,e.secteur?[4,this.localiteService.getOneSecteur(e.secteur.id).toPromise()]:[3,15];case 14:return l=p.sent(),[3,16];case 15:l=null,p.label=16;case 16:b.secteur=l,(this.isNew?this.userService.add(e):this.userService.update(this.userId,e)).subscribe((function(){d.initLoc(),d.utils.showNotif("Operation effectu\xe9e avec succ\xe8s","success"),d.isNew?d.resetForm():d.router.navigate(["users"])}),(function(e){d.utils.showNotif("Une erreur est survenue lors de l'op\xe9ration ","danger")})),p.label=17;case 17:return[2]}}))}))},e.prototype.loadInfos=function(){this.regions$=this.localiteService.getRegions$(),this.prefectures$=this.localiteService.getPrefectures$(),this.communes$=this.localiteService.getCommunes$(),this.quartiers$=this.localiteService.getQuartiers$(),this.secteurs$=this.localiteService.getSecteurs$(),this.initLoc()},e.prototype.initLoc=function(){this.localiteService.subjectRegion.next(0),this.localiteService.subjectPrefecture.next(0),this.localiteService.subjectCommune.next(0),this.localiteService.subjectQuartier.next(0),this.localiteService.subjectSecteur.next(0)},e.prototype.onChangeSelectLocalite=function(){var e=this;this.userForm.get("region.id").valueChanges.subscribe((function(t){e.localiteService.subjectPrefecture.next(t)})),this.userForm.get("prefecture.id").valueChanges.subscribe((function(t){e.localiteService.subjectCommune.next(t)})),this.userForm.get("commune.id").valueChanges.subscribe((function(t){e.localiteService.subjectQuartier.next(t)})),this.userForm.get("quartier.id").valueChanges.subscribe((function(t){e.localiteService.subjectSecteur.next(t)}))},e.prototype.mapUser=function(){return Se(this,void 0,void 0,(function(){var e;return ve(this,(function(t){switch(t.label){case 0:return[4,this.userService.getOne(this.userId).toPromise()];case 1:return e=t.sent(),this.userForm.patchValue({nom:e.nom,prenom:e.prenom,email:e.email,telephone:e.telephone,role:{id:e.role.id},region:e.region?{id:e.region.id}:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),prefecture:e.prefecture?{id:e.prefecture.id}:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),commune:e.commune?{id:e.commune.id}:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),quartier:e.quartier?{id:e.quartier.id}:this.fb.group({id:[null,[F.u.pattern(L.e)]]}),secteur:e.secteur?{id:e.secteur.id}:this.fb.group({id:[null,[F.u.pattern(L.e)]]})}),[2]}}))}))},e.prototype.onEdit=function(){!this.isNew&&this.userId>0&&this.mapUser()},e.prototype.onNewQuartier=function(e){e.done&&(this.localiteService.subjectQuartier.next(this.communeId),this.userForm.get("quartier.id").setValue(e.id),this.modalReference.close())},e.prototype.onNewSecteur=function(e){e.done&&(this.localiteService.subjectSecteur.next(this.quartierId),this.userForm.get("secteur.id").setValue(e.id),this.modalReference.close())},e.prototype.onOpenModal=function(e,t){if(void 0===t&&(t=!1),t){if(this.quartierId=this.userForm.get("quartier.id").value,!this.quartierId)return void this.snackBar.open("Selectionnez un quartier","",{duration:3e3,verticalPosition:"top",horizontalPosition:"right",panelClass:["my-snack-warning"]})}else if(this.communeId=this.userForm.get("commune.id").value,!this.communeId)return void this.snackBar.open("Selectionnez une commune ou sous-prefecture","",{duration:3e3,verticalPosition:"top",horizontalPosition:"right",panelClass:["my-snack-warning"]});this.modalReference=this.modalService.open(e,{backdrop:"static",centered:!0})},e.\u0275fac=function(t){return new(t||e)(l.Nb(F.c),l.Nb(d.a),l.Nb(d.e),l.Nb(r.c),l.Nb(se.a),l.Nb(p.a),l.Nb(P.a),l.Nb(K.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-edit-user"]],decls:131,vars:29,consts:[[1,"card"],[1,"card-header","bg-default"],[1,"row"],[1,"col-sm-12","form-inline"],["mat-mini-fab","","color","info","routerLink",".."],[1,"card-title","ml-1","text-white"],[1,"card-body"],[3,"filterBy","diameter"],["usrSpinner",""],[1,"col-md-8","offset-md-2","col-sm-12"],[3,"formGroup"],[1,"col-12"],["matInput","","type","text","formControlName","nom"],["matInput","","type","text","formControlName","prenom"],["matInput","","type","number","minlength","1","formControlName","telephone"],["matInput","","type","email","formControlName","email"],[1,"fieldset-border"],["formGroupName","region"],["formControlName","id"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","prefecture"],["formGroupName","commune"],["formGroupName","quartier"],[1,"col-10"],[1,"col-2","form-inline"],["type","button","mat-mini-fab","","color","info",3,"click"],["formGroupName","secteur"],["formGroupName","role"],[1,"text-center"],["type","button","mat-raised-button","","color","primary",3,"disabled","click"],["contentQuartier",""],["contentSecteur",""],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"isNew","communeId","isDone"],[3,"isNew","quartierId","isDone"]],template:function(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"button",4),l.Tb(5,"mat-icon"),l.Jc(6,"reply"),l.Sb(),l.Sb(),l.Tb(7,"h2",5),l.Jc(8),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(9,"div",6),l.Ob(10,"app-spinner",7,8),l.Tb(12,"div",2),l.Tb(13,"div",9),l.Tb(14,"div"),l.Tb(15,"form",10),l.Tb(16,"div",2),l.Tb(17,"div",11),l.Tb(18,"mat-form-field"),l.Tb(19,"mat-label"),l.Jc(20,"Nom"),l.Sb(),l.Ob(21,"input",12),l.Tb(22,"mat-error"),l.Jc(23,"Le nom est obligatoire et contient au moins 3 caract\xe8res"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(24,"div",2),l.Tb(25,"div",11),l.Tb(26,"mat-form-field"),l.Tb(27,"mat-label"),l.Jc(28,"Prenom"),l.Sb(),l.Ob(29,"input",13),l.Tb(30,"mat-error"),l.Jc(31,"Le prenom est obligatoire et contient au moins 3 caract\xe8res"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(32,"div",2),l.Tb(33,"div",11),l.Tb(34,"mat-form-field"),l.Tb(35,"mat-label"),l.Jc(36,"Telephone"),l.Sb(),l.Ob(37,"input",14),l.Tb(38,"mat-error"),l.Jc(39,"le numero de telephone est incorrect"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(40,"div",2),l.Tb(41,"div",11),l.Tb(42,"mat-form-field"),l.Tb(43,"mat-label"),l.Jc(44,"Email"),l.Sb(),l.Ob(45,"input",15),l.Tb(46,"mat-error"),l.Jc(47,"L'adresse email est obligatoire et doit respecter le bon format"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(48,"fieldset",16),l.Tb(49,"legend",16),l.Jc(50,"Localit\xe9"),l.Sb(),l.Tb(51,"div"),l.Tb(52,"div",17),l.Tb(53,"div",2),l.Tb(54,"div",11),l.Tb(55,"mat-form-field"),l.Tb(56,"mat-label"),l.Jc(57,"Region"),l.Sb(),l.Tb(58,"mat-select",18),l.Hc(59,ge,2,2,"mat-option",19),l.jc(60,"async"),l.Sb(),l.Tb(61,"mat-error"),l.Jc(62,"La region est obligatoire"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(63,"div",20),l.Tb(64,"div",2),l.Tb(65,"div",11),l.Tb(66,"mat-form-field"),l.Tb(67,"mat-label"),l.Jc(68,"Prefecture"),l.Sb(),l.Tb(69,"mat-select",18),l.Hc(70,Te,2,2,"mat-option",19),l.jc(71,"async"),l.Sb(),l.Tb(72,"mat-error"),l.Jc(73,"La prefecture est obligatoire"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(74,"div",21),l.Tb(75,"div",2),l.Tb(76,"div",11),l.Tb(77,"mat-form-field"),l.Tb(78,"mat-label"),l.Jc(79,"Commune/Sous-prefecture"),l.Sb(),l.Tb(80,"mat-select",18),l.Hc(81,ye,2,2,"mat-option",19),l.jc(82,"async"),l.Sb(),l.Tb(83,"mat-error"),l.Jc(84,"La commune ou sous-prefecture est obligatoire"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(85,"div",22),l.Tb(86,"div",2),l.Tb(87,"div",23),l.Tb(88,"mat-form-field"),l.Tb(89,"mat-label"),l.Jc(90,"Quartier/Districte"),l.Sb(),l.Tb(91,"mat-select",18),l.Hc(92,Ae,2,2,"mat-option",19),l.jc(93,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(94,"div",24),l.Tb(95,"button",25),l.ec("click",(function(){l.zc(i);var e=l.xc(128);return t.onOpenModal(e)})),l.Tb(96,"mat-icon"),l.Jc(97,"add"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(98,"div",26),l.Tb(99,"div",2),l.Tb(100,"div",23),l.Tb(101,"mat-form-field"),l.Tb(102,"mat-label"),l.Jc(103,"Secteur"),l.Sb(),l.Tb(104,"mat-select",18),l.Hc(105,we,2,2,"mat-option",19),l.jc(106,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(107,"div",24),l.Tb(108,"button",25),l.ec("click",(function(){l.zc(i);var e=l.xc(130);return t.onOpenModal(e,!0)})),l.Tb(109,"mat-icon"),l.Jc(110,"add"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(111,"div",27),l.Tb(112,"div",2),l.Tb(113,"div",11),l.Tb(114,"mat-form-field"),l.Tb(115,"mat-label"),l.Jc(116,"Role"),l.Sb(),l.Tb(117,"mat-select",18),l.Hc(118,ke,3,5,"mat-option",19),l.jc(119,"async"),l.Sb(),l.Tb(120,"mat-error"),l.Jc(121,"Le role est obligatoire"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(122,"div",28),l.Tb(123,"button",29),l.ec("click",(function(){return t.onSubmit()})),l.jc(124,"async"),l.jc(125,"async"),l.Jc(126," Enregistrer "),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Hc(127,Ie,8,2,"ng-template",null,30,l.Ic),l.Hc(129,Je,8,2,"ng-template",null,31,l.Ic)}if(2&e){var n=l.xc(11);l.Ab(8),l.Lc(" ",t.isNew?"Enregistrement d'un utilisateur":"Modification d'un utilisateur"," "),l.Ab(2),l.pc("filterBy",t.userUrl)("diameter",30),l.Ab(5),l.pc("formGroup",t.userForm),l.Ab(44),l.pc("ngForOf",l.kc(60,13,t.regions$)),l.Ab(11),l.pc("ngForOf",l.kc(71,15,t.prefectures$)),l.Ab(11),l.pc("ngForOf",l.kc(82,17,t.communes$)),l.Ab(11),l.pc("ngForOf",l.kc(93,19,t.quartiers$)),l.Ab(13),l.pc("ngForOf",l.kc(106,21,t.secteurs$)),l.Ab(13),l.pc("ngForOf",l.kc(119,23,t.roles$)),l.Ab(5),l.Fb("spinner",l.kc(124,25,n.loadingEvent$)),l.pc("disabled",t.userForm.invalid||l.kc(125,27,n.loadingEvent$))}},directives:[m.a,d.f,f.a,h.a,F.w,F.m,F.e,_.c,_.f,E.a,F.b,F.l,F.d,_.b,F.q,F.h,F.f,ue.a,n.l,be.j,le.a,he],pipes:[n.b,Q],styles:['.mat-form-field[_ngcontent-%COMP%]{font-size:17px;width:100%}@-webkit-keyframes spinner{to{transform:rotate(1turn)}}@keyframes spinner{to{transform:rotate(1turn)}}.spinner[_ngcontent-%COMP%]:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #fff;border-top-color:#000;-webkit-animation:spinner .8s linear infinite;animation:spinner .8s linear infinite}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none}']}),e}(),Ne=i("M9IT"),Ce=i("Dh3D"),xe=i("+0xr"),Re=i("PSD3"),Fe=i.n(Re),Le=i("7EHt");function Pe(e,t){if(1&e&&(l.Tb(0,"mat-option",14),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function _e(e,t){if(1&e&&(l.Tb(0,"mat-option",14),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function Ee(e,t){if(1&e&&(l.Tb(0,"mat-option",14),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function je(e,t){if(1&e&&(l.Tb(0,"mat-option",14),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function He(e,t){if(1&e&&(l.Tb(0,"mat-option",14),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.id),l.Ab(1),l.Kc(i.nom)}}function Me(e,t){if(1&e&&(l.Tb(0,"mat-option",14),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.pc("value",i.nom),l.Ab(1),l.Kc(i.nom)}}var $e=function(){function e(e,t){this.localiteService=e,this.UserService=t,this.isLoading=!1,this.expanded=!1,this.onSearchEvent=new l.o,this.panelOpenState=!1,this.localites=L.b}return e.prototype.ngOnInit=function(){this.params={dateDebut:null,dateFin:null},this.loadLocaliteInfos()},e.prototype.loadLocaliteInfos=function(){this.regions$=this.localiteService.getRegions$(),this.prefectures$=this.localiteService.getPrefectures$(),this.communes$=this.localiteService.getCommunes$(),this.quartiers$=this.localiteService.getQuartiers$(),this.secteurs$=this.localiteService.getSecteurs$(),this.roles$=this.UserService.getAllRoles().toPromise(),this.localiteService.subjectRegion.next(0),this.localiteService.subjectPrefecture.next(0),this.localiteService.subjectCommune.next(0),this.localiteService.subjectQuartier.next(0),this.localiteService.subjectSecteur.next(0)},e.prototype.onSelectLocaliteChange=function(e){e===L.b.REGION?this.localiteService.subjectPrefecture.next(this.params.idRegion):e===L.b.PREFECTURE?this.localiteService.subjectCommune.next(this.params.idPrefecture):e===L.b.COMMUNE?this.localiteService.subjectQuartier.next(this.params.idCommune):e===L.b.QUARTIER&&this.localiteService.subjectSecteur.next(this.params.idQuartier)},e.prototype.onSearch=function(){this.params&&this.onSearchEvent.emit(this.params)},e.prototype.resetForm=function(){this.params={}},e.\u0275fac=function(t){return new(t||e)(l.Nb(se.a),l.Nb(r.c))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-search-local"]],inputs:{isLoading:"isLoading",expanded:"expanded"},outputs:{onSearchEvent:"onSearchEvent"},decls:61,vars:26,consts:[[1,"row"],[1,"col-12"],[3,"expanded","opened","closed"],[1,"col-md-4","col-sm-12"],["name","region",3,"ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","prefecture",3,"ngModel","selectionChange","ngModelChange"],["name","commune",3,"ngModel","selectionChange","ngModelChange"],["name","quartier",3,"ngModel","selectionChange","ngModelChange"],["name","secteur",3,"ngModel","ngModelChange"],["name","role",3,"ngModel","ngModelChange"],[1,"col-md-4","col-sm-12","form-inline"],["type","button","mat-raised-button","","color","info",1,"mr-1",3,"disabled","click"],["type","button","mat-raised-button","",3,"click"],[3,"value"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"mat-accordion"),l.Tb(3,"mat-expansion-panel",2),l.ec("opened",(function(){return t.panelOpenState=!0}))("closed",(function(){return t.panelOpenState=!1})),l.Tb(4,"mat-expansion-panel-header"),l.Tb(5,"mat-panel-title"),l.Jc(6,"Recherche"),l.Sb(),l.Sb(),l.Tb(7,"form"),l.Tb(8,"div",0),l.Tb(9,"div",3),l.Tb(10,"mat-form-field"),l.Tb(11,"mat-label"),l.Jc(12,"Region"),l.Sb(),l.Tb(13,"mat-select",4),l.ec("selectionChange",(function(){return t.onSelectLocaliteChange(t.localites.REGION)}))("ngModelChange",(function(e){return t.params.idRegion=e})),l.Hc(14,Pe,2,2,"mat-option",5),l.jc(15,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(16,"div",3),l.Tb(17,"mat-form-field"),l.Tb(18,"mat-label"),l.Jc(19,"Prefecture"),l.Sb(),l.Tb(20,"mat-select",6),l.ec("selectionChange",(function(){return t.onSelectLocaliteChange(t.localites.PREFECTURE)}))("ngModelChange",(function(e){return t.params.idPrefecture=e})),l.Hc(21,_e,2,2,"mat-option",5),l.jc(22,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(23,"div",3),l.Tb(24,"mat-form-field"),l.Tb(25,"mat-label"),l.Jc(26,"Commune/Sous-prefecture"),l.Sb(),l.Tb(27,"mat-select",7),l.ec("selectionChange",(function(){return t.onSelectLocaliteChange(t.localites.COMMUNE)}))("ngModelChange",(function(e){return t.params.idCommune=e})),l.Hc(28,Ee,2,2,"mat-option",5),l.jc(29,"async"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(30,"div",0),l.Tb(31,"div",3),l.Tb(32,"mat-form-field"),l.Tb(33,"mat-label"),l.Jc(34,"Quartier/District"),l.Sb(),l.Tb(35,"mat-select",8),l.ec("selectionChange",(function(){return t.onSelectLocaliteChange(t.localites.QUARTIER)}))("ngModelChange",(function(e){return t.params.idQuartier=e})),l.Hc(36,je,2,2,"mat-option",5),l.jc(37,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(38,"div",3),l.Tb(39,"mat-form-field"),l.Tb(40,"mat-label"),l.Jc(41,"Secteur"),l.Sb(),l.Tb(42,"mat-select",9),l.ec("ngModelChange",(function(e){return t.params.idSecteur=e})),l.Hc(43,He,2,2,"mat-option",5),l.jc(44,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(45,"div",3),l.Tb(46,"mat-form-field"),l.Tb(47,"mat-label"),l.Jc(48,"Role"),l.Sb(),l.Tb(49,"mat-select",10),l.ec("ngModelChange",(function(e){return t.params.role=e})),l.Hc(50,Me,2,2,"mat-option",5),l.jc(51,"async"),l.Sb(),l.Sb(),l.Sb(),l.Tb(52,"div",11),l.Tb(53,"button",12),l.ec("click",(function(){return t.onSearch()})),l.Tb(54,"mat-icon"),l.Jc(55,"search"),l.Sb(),l.Jc(56," Rechercher "),l.Sb(),l.Tb(57,"button",13),l.ec("click",(function(){return t.resetForm()})),l.Tb(58,"mat-icon"),l.Jc(59,"restart_alt"),l.Sb(),l.Jc(60," Annuler "),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e&&(l.Ab(3),l.pc("expanded",t.expanded),l.Ab(10),l.pc("ngModel",t.params.idRegion),l.Ab(1),l.pc("ngForOf",l.kc(15,14,t.regions$)),l.Ab(6),l.pc("ngModel",t.params.idPrefecture),l.Ab(1),l.pc("ngForOf",l.kc(22,16,t.prefectures$)),l.Ab(6),l.pc("ngModel",t.params.idCommune),l.Ab(1),l.pc("ngForOf",l.kc(29,18,t.communes$)),l.Ab(7),l.pc("ngModel",t.params.idQuartier),l.Ab(1),l.pc("ngForOf",l.kc(37,20,t.quartiers$)),l.Ab(6),l.pc("ngModel",t.params.idSecteur),l.Ab(1),l.pc("ngForOf",l.kc(44,22,t.secteurs$)),l.Ab(6),l.pc("ngModel",t.params.role),l.Ab(1),l.pc("ngForOf",l.kc(51,24,t.roles$)),l.Ab(3),l.pc("disabled",t.isLoading))},directives:[Le.a,Le.c,Le.d,Le.e,F.w,F.m,F.n,_.c,_.f,ue.a,F.l,F.o,n.l,m.a,f.a,be.j],pipes:[n.b],styles:[""]}),e}(),Ue=i("0Sq8"),De=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ze=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function c(e){try{s(n.next(e))}catch(t){o(t)}}function a(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(c,a)}s((n=n.apply(e,t||[])).next())}))},qe=function(e,t){var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,n=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(a){o=[6,a],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function Ke(e,t){1&e&&(l.Tb(0,"button",14),l.Tb(1,"mat-icon"),l.Jc(2,"add"),l.Sb(),l.Sb())}function Qe(e,t){1&e&&(l.Tb(0,"mat-header-cell",32),l.Tb(1,"strong"),l.Jc(2,"EMAIL"),l.Sb(),l.Sb())}function Ve(e,t){if(1&e&&(l.Tb(0,"mat-cell"),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.Ab(1),l.Kc(i.email)}}function Ge(e,t){1&e&&(l.Tb(0,"mat-header-cell",32),l.Tb(1,"strong"),l.Jc(2,"NOM et PRENOM"),l.Sb(),l.Sb())}function Be(e,t){if(1&e&&(l.Tb(0,"mat-cell"),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.Ab(1),l.Mc("",i.nom," ",i.prenom,"")}}function We(e,t){1&e&&(l.Tb(0,"mat-header-cell",32),l.Tb(1,"strong"),l.Jc(2,"TELEPHONE"),l.Sb(),l.Sb())}function Xe(e,t){if(1&e&&(l.Tb(0,"mat-cell"),l.Jc(1),l.Sb()),2&e){var i=t.$implicit;l.Ab(1),l.Kc(i.telephone)}}function Ye(e,t){1&e&&(l.Tb(0,"mat-header-cell",32),l.Tb(1,"strong"),l.Jc(2,"ROLE"),l.Sb(),l.Sb())}function Ze(e,t){if(1&e&&(l.Tb(0,"mat-cell"),l.Jc(1),l.jc(2,"roleNameFormat"),l.Sb()),2&e){var i=t.$implicit;l.Ab(1),l.Kc(l.lc(2,1,i.role.nom,i.role.nom))}}function et(e,t){1&e&&(l.Tb(0,"mat-header-cell",32),l.Tb(1,"strong"),l.Jc(2,"STATUT"),l.Sb(),l.Sb())}function tt(e,t){if(1&e){var i=l.Ub();l.Tb(0,"mat-cell"),l.Tb(1,"mat-slide-toggle",33),l.ec("change",(function(){l.zc(i);var e=t.$implicit;return l.ic(3).onChangeStatus(e.id)})),l.Sb(),l.Sb()}if(2&e){var n=t.$implicit;l.Ab(1),l.pc("checked","Activated"===n.statut)}}function it(e,t){1&e&&(l.Tb(0,"mat-header-cell",32),l.Tb(1,"strong"),l.Jc(2,"OPTIONS"),l.Sb(),l.Sb())}var nt=function(e){return["info",e]};function rt(e,t){if(1&e&&(l.Tb(0,"button",37),l.Tb(1,"mat-icon"),l.Jc(2,"visibility"),l.Sb(),l.Sb()),2&e){var i=l.ic().$implicit;l.pc("routerLink",l.tc(1,nt,i.id))}}var ot=function(e){return{id:e}},ct=function(e){return["edit",e]};function at(e,t){if(1&e&&(l.Tb(0,"button",38),l.Tb(1,"mat-icon"),l.Jc(2,"edit"),l.Sb(),l.Sb()),2&e){var i=l.ic().$implicit;l.pc("routerLink",l.tc(3,ct,l.tc(1,ot,i.id)))}}function st(e,t){if(1&e){var i=l.Ub();l.Tb(0,"button",39),l.ec("click",(function(){l.zc(i);var e=l.ic().$implicit,t=l.ic(3),n=l.xc(17);return t.openModalReinitialisationPassword(n,e)})),l.Tb(1,"mat-icon"),l.Jc(2,"autorenew"),l.Sb(),l.Sb()}}function ut(e,t){if(1&e&&(l.Tb(0,"mat-cell"),l.Hc(1,rt,3,3,"button",34),l.Hc(2,at,3,5,"button",35),l.Hc(3,st,3,0,"button",36),l.Sb()),2&e){var i=l.ic(3);l.Ab(1),l.pc("ngIf",i.permissions.can_view_info),l.Ab(1),l.pc("ngIf",i.permissions.can_edit),l.Ab(1),l.pc("ngIf",i.permissions.can_edit)}}function bt(e,t){1&e&&l.Ob(0,"mat-header-row")}function lt(e,t){1&e&&l.Ob(0,"mat-row")}function dt(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div"),l.Tb(1,"div",16),l.Tb(2,"div",17),l.Tb(3,"mat-form-field"),l.Tb(4,"input",18),l.ec("keyup",(function(e){return l.zc(i),l.ic(2).applyFilter(e.target.value)})),l.Sb(),l.Sb(),l.Sb(),l.Tb(5,"mat-table",19),l.Rb(6,20),l.Hc(7,Qe,3,0,"mat-header-cell",21),l.Hc(8,Ve,2,1,"mat-cell",22),l.Qb(),l.Rb(9,23),l.Hc(10,Ge,3,0,"mat-header-cell",21),l.Hc(11,Be,2,2,"mat-cell",22),l.Qb(),l.Rb(12,24),l.Hc(13,We,3,0,"mat-header-cell",21),l.Hc(14,Xe,2,1,"mat-cell",22),l.Qb(),l.Rb(15,25),l.Hc(16,Ye,3,0,"mat-header-cell",21),l.Hc(17,Ze,3,4,"mat-cell",22),l.Qb(),l.Rb(18,26),l.Hc(19,et,3,0,"mat-header-cell",21),l.Hc(20,tt,2,1,"mat-cell",22),l.Qb(),l.Rb(21,27),l.Hc(22,it,3,0,"mat-header-cell",21),l.Hc(23,ut,4,3,"mat-cell",22),l.Qb(),l.Hc(24,bt,1,0,"mat-header-row",28),l.Hc(25,lt,1,0,"mat-row",29),l.Sb(),l.Tb(26,"mat-paginator",30,31),l.ec("page",(function(e){return l.zc(i),l.ic(2).pageChanged(e)})),l.jc(28,"tableOptions"),l.Sb(),l.Sb(),l.Sb()}if(2&e){var n=l.ic(2);l.Ab(1),l.pc("hidden",!n.dataSource||0===n.dataSource.data.length),l.Ab(4),l.pc("dataSource",n.dataSource),l.Ab(19),l.pc("matHeaderRowDef",n.displayedColumns),l.Ab(1),l.pc("matRowDefColumns",n.displayedColumns),l.Ab(1),l.pc("length",n.totalRows)("pageIndex",n.currentPage)("pageSize",n.pageSize)("pageSizeOptions",l.kc(28,8,n.dataSource.data.length))}}function pt(e,t){1&e&&(l.Tb(0,"div",40),l.Jc(1," Aucun cas trouv\xe9 !!! "),l.Sb())}function mt(e,t){if(1&e&&(l.Tb(0,"div"),l.Hc(1,dt,29,10,"div",12),l.Hc(2,pt,2,0,"div",15),l.jc(3,"async"),l.Sb()),2&e){var i=l.ic();l.Ab(1),l.pc("ngIf",i.dataSource.data.length>0),l.Ab(1),l.pc("ngIf",0===i.dataSource.data.length&&!1===l.kc(3,2,i.spinner.loadingEvent$))}}function ft(e,t){if(1&e){var i=l.Ub();l.Tb(0,"div",41),l.Tb(1,"span",42),l.Jc(2,"R\xe9initialisation mot de passe"),l.Sb(),l.Tb(3,"button",43),l.ec("click",(function(){return(0,t.close)("Close click")})),l.Tb(4,"span",44),l.Jc(5,"\xd7"),l.Sb(),l.Sb(),l.Sb(),l.Tb(6,"div",45),l.Tb(7,"form",46),l.Tb(8,"div",2),l.Tb(9,"div",47),l.Tb(10,"mat-form-field"),l.Tb(11,"mat-label"),l.Jc(12,"Option"),l.Sb(),l.Tb(13,"mat-select",48),l.Tb(14,"mat-option",49),l.Jc(15,"SMS"),l.Sb(),l.Tb(16,"mat-option",50),l.Jc(17,"EMAIL"),l.Sb(),l.Sb(),l.Tb(18,"mat-error"),l.Jc(19,"L'option d'envoi est obligatoire"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(20,"div",51),l.Tb(21,"p",52),l.Jc(22),l.Sb(),l.Tb(23,"button",53),l.ec("click",(function(){return l.zc(i),l.ic().onCloseModal()})),l.Jc(24," Annuler "),l.Sb(),l.Tb(25,"button",54),l.ec("click",(function(){return l.zc(i),l.ic().onReinitialisationPassword()})),l.Jc(26," R\xe9initialiser "),l.Sb(),l.Sb(),l.Sb(),l.Sb()}if(2&e){var n=l.ic();l.Ab(7),l.pc("formGroup",n.reinitialisationForm),l.Ab(15),l.Kc(n.messageAttente),l.Ab(3),l.pc("disabled",n.reinitialisationForm.invalid)}}var ht=function(){function e(e,t,i,n,o,c){this.userService=e,this.auth=t,this.utils=i,this.fb=n,this.modalService=o,this.cdrf=c,this.subject=new a.a(0),this.pageSize=10,this.currentPage=0,this.totalRows=0,this.permissions={can_add:!1,can_edit:!1,can_delete:!1,can_view_info:!1},this.userUrl=r.b,this.userId=0,this.messageAttente="",this.displayedColumns=["nom_prenom","email","telephone","role","statut","option"],this.dataSource=new xe.k([])}return e.prototype.getElement=function(e){return void 0===e&&(e={page:this.currentPage,size:this.pageSize}),ze(this,void 0,void 0,(function(){var t=this;return qe(this,(function(i){return this.userService.getAll(e).subscribe((function(e){var i=e.data.map((function(i){return t.totalRows=e.totalItem,{id:i.id,nom:i.nom,prenom:i.prenom,email:i.email,localite:i.localite,telephone:i.telephone,username:i.username,password:i.password,statut:i.statut,role:i.role,fonction:i.fonction}}),(function(e){console.log("error: ",e)}));t.dataSource.data=i,setTimeout((function(){t.paginator.pageIndex=t.currentPage,t.paginator.length=t.totalRows})),t.dataSource._updateChangeSubscription(),t.dataSource.paginator=t.paginator,t.dataSource.sort=t.sort})),[2]}))}))},e.prototype.ngAfterViewInit=function(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},e.prototype.ngAfterContentChecked=function(){this.cdrf.detectChanges()},e.prototype.ngOnInit=function(){this.setPermissions(),this.getElement(),this.reinitialisationForm=this.fb.group({mode:["",[F.u.required]]})},e.prototype.onRefresh=function(){this.dataSource.data=[],this.getElement()},e.prototype.onDelete=function(e){var t=this;this.userService.delete(e).subscribe((function(){t.utils.showNotif("Utilisateur supprim\xe9 avec succ\xe8s ","success"),t.onRefresh()}),(function(e){t.utils.showNotif("Une erreur est survenue lors de l'operation "+e,"danger")}))},e.prototype.setPermissions=function(){var e=this.auth.getPermissions();this.permissions={can_add:e.includes(L.c.CAN_ADD_USER),can_edit:e.includes(L.c.CAN_UPDATE_USER),can_delete:e.includes(L.c.CAN_DELETE_USER),can_view_info:e.includes(L.c.CAN_DELETE_USER)}},e.prototype.onChangeStatus=function(e){var t=this;this.userService.changeStatus(e).subscribe((function(){return t.subject.next(0)}))},e.prototype.openModalReinitialisationPassword=function(e,t){this.userId=t.id,this.modalRef=this.modalService.open(e,{backdrop:"static"})},e.prototype.onReinitialisationPassword=function(){return ze(this,void 0,void 0,(function(){var e=this;return qe(this,(function(t){return this.messageAttente="Veillez patienter pendant la g\xe9n\xe9ration du nouveau mot de passe",this.userService.reinitialisationPassword({idUser:this.userId,option:this.reinitialisationForm.value.mode}).subscribe((function(t){e.messageAttente="",e.onCloseModal();var i=t.status;return Fe.a.fire({title:"R\xe9initialisation mot de passe",icon:i?"success":"error",text:i?"Le mot de passe a \xe9t\xe9 r\xe9initiali\xe9 avec succ\xe8s":"Une erreur s'est produite",showConfirmButton:!0})})),[2]}))}))},e.prototype.onCloseModal=function(){this.modalRef.close()},e.prototype.applyFilter=function(e){e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e},e.prototype.onSearch=function(e){e&&(e.page=0,e.size=10,console.log("Params ",e),this.getElement(e))},e.prototype.iniData=function(e){return void 0===e&&(e={page:this.currentPage,size:this.pageSize}),ze(this,void 0,void 0,(function(){return qe(this,(function(e){return[2]}))}))},e.prototype.pageChanged=function(e){console.log({event:e}),this.pageSize=e.pageSize,this.currentPage=e.pageIndex,this.totalRows=e.length,this.getElement({page:this.currentPage,size:this.pageSize})},e.\u0275fac=function(t){return new(t||e)(l.Nb(r.c),l.Nb(q.a),l.Nb(p.a),l.Nb(F.c),l.Nb(K.a),l.Nb(l.h))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-list-user"]],viewQuery:function(e,t){var i;1&e&&(l.Nc(Ne.a,!0),l.Nc(Ce.a,!0)),2&e&&(l.wc(i=l.fc())&&(t.paginator=i.first),l.wc(i=l.fc())&&(t.sort=i.first))},decls:18,vars:3,consts:[[1,"card"],[1,"card-header","bg-default"],[1,"row"],[1,"col-sm-8"],[1,"card-title","text-white"],[1,"nc-icon","nc-single-02"],[1,"col-sm-4","text-right","mt-2"],["mat-raised-button","","routerLink","edit","class","mr-1","color","info",4,"ngIf"],["mat-raised-button","","color","info",3,"click"],[3,"onSearchEvent"],[1,"card-body"],[3,"filterBy"],[4,"ngIf"],["reinitialisationPassword",""],["mat-raised-button","","routerLink","edit","color","info",1,"mr-1"],["class","text-info text-center mt-2",4,"ngIf"],[1,"table-responsive","mb-2",3,"hidden"],[1,"mat-table-header"],["matInput","","placeholder","Rechercher",3,"keyup"],["matSort","",3,"dataSource"],["matColumnDef","email"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","nom_prenom"],["matColumnDef","telephone"],["matColumnDef","role"],["matColumnDef","statut"],["matColumnDef","option"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"length","pageIndex","pageSize","pageSizeOptions","page"],["paginator",""],["mat-sort-header",""],["color","primary",3,"checked","change"],["mat-mini-fab","","color","own",3,"routerLink",4,"ngIf"],["mat-mini-fab","","color","info",3,"routerLink",4,"ngIf"],["type","button","mat-mini-fab","","color","warning",3,"click",4,"ngIf"],["mat-mini-fab","","color","own",3,"routerLink"],["mat-mini-fab","","color","info",3,"routerLink"],["type","button","mat-mini-fab","","color","warning",3,"click"],[1,"text-info","text-center","mt-2"],[1,"modal-header","bg-default"],[1,"modal-title","h4","text-white"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"col-12"],["formControlName","mode"],["value","SMS"],["value","EMAIL"],[1,"text-center"],[1,"text","text-warning",2,"font-weight","bold"],["type","button","color","danger",1,"btn","btn-danger",3,"click"],["type","button","mat-raised-button","","color","primary",2,"margin-left","10px",3,"disabled","click"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"h2",4),l.Ob(5,"i",5),l.Jc(6," Liste des utilisateurs "),l.Sb(),l.Sb(),l.Tb(7,"div",6),l.Hc(8,Ke,3,0,"button",7),l.Tb(9,"button",8),l.ec("click",(function(){return t.onRefresh()})),l.Tb(10,"mat-icon"),l.Jc(11,"refresh"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(12,"app-search-local",9),l.ec("onSearchEvent",(function(e){return t.onSearch(e)})),l.Sb(),l.Tb(13,"div",10),l.Ob(14,"app-spinner",11),l.Hc(15,mt,4,4,"div",12),l.Sb(),l.Sb(),l.Hc(16,ft,27,3,"ng-template",null,13,l.Ic)),2&e&&(l.Ab(8),l.pc("ngIf",t.permissions.can_add),l.Ab(6),l.pc("filterBy",t.userUrl),l.Ab(1),l.pc("ngIf",t.dataSource.data.length))},directives:[n.m,m.a,f.a,$e,h.a,d.f,_.c,E.a,xe.j,Ce.a,xe.c,xe.e,xe.b,xe.g,xe.i,Ne.a,xe.d,Ce.b,xe.a,S.a,xe.f,xe.h,F.w,F.m,F.e,_.f,ue.a,F.l,F.d,be.j,_.b],pipes:[n.b,Ue.a,Q],styles:[""]}),function(e,t,i,n){var r,o=arguments.length,c=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(o<3?r(c):o>3?r(t,i,c):r(t,i))||c);o>3&&c&&Object.defineProperty(t,i,c)}([Object(b.a)({html:"Voulez-vous supprimer cet utilisateur ?",icon:"warning"}),De("design:type",Function),De("design:paramtypes",[Number]),De("design:returntype",void 0)],e.prototype,"onDelete",null),e}(),St=function(e){return{active:e}};function vt(e,t){if(1&e&&(l.Tb(0,"button",10),l.Jc(1,"Utilisateurs"),l.Sb()),2&e){l.ic();var i=l.xc(5),n=l.xc(7),r=l.xc(9);l.pc("ngClass",l.tc(1,St,i.isActive||n.isActive||r.isActive))}}function gt(e,t){1&e&&(l.Tb(0,"button",11),l.Jc(1,"Roles"),l.Sb())}var Tt=function(){return{exact:!0}},yt=function(){function e(e){this.auth=e,this.permissions={can_view_user_list:!1,can_view_role_list:!1}}return e.prototype.ngOnInit=function(){this.setPermissions()},e.prototype.setPermissions=function(){var e=this.auth.getPermissions();this.permissions={can_view_user_list:e.includes(L.c.CAN_VIEW_USERS_LIST),can_view_role_list:e.includes(L.c.CAN_VIEW_ROLES_LIST)}},e.\u0275fac=function(t){return new(t||e)(l.Nb(q.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-user-management"]],decls:11,vars:6,consts:[[1,"main-content"],[1,"text-center","bg-dark-gray","m-3"],["mat-button","","routerLink","/users","routerLinkActive","active",3,"ngClass",4,"ngIf"],["mat-button","","routerLink","roles","routerLinkActive","active",4,"ngIf"],["routerLink","edit","routerLinkActive","",2,"display","none",3,"routerLinkActiveOptions"],["editUserActive","routerLinkActive"],["routerLink","/users","routerLinkActive","",2,"display","none",3,"routerLinkActiveOptions"],["listUser","routerLinkActive"],["routerLink","info","routerLinkActive","",2,"display","none"],["infoUserActive","routerLinkActive"],["mat-button","","routerLink","/users","routerLinkActive","active",3,"ngClass"],["mat-button","","routerLink","roles","routerLinkActive","active"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Hc(2,vt,2,3,"button",2),l.Hc(3,gt,2,0,"button",3),l.Ob(4,"a",4,5),l.Ob(6,"a",6,7),l.Ob(8,"a",8,9),l.Sb(),l.Ob(10,"router-outlet"),l.Sb()),2&e&&(l.Ab(2),l.pc("ngIf",t.permissions.can_view_user_list),l.Ab(1),l.pc("ngIf",t.permissions.can_view_role_list),l.Ab(1),l.pc("routerLinkActiveOptions",l.sc(4,Tt)),l.Ab(2),l.pc("routerLinkActiveOptions",l.sc(5,Tt)))},directives:[n.m,d.h,d.g,d.j,m.a,d.f,n.k],styles:[".active[_ngcontent-%COMP%]{background-color:#66615b!important;color:#f5f5f5!important}button[routerlink][_ngcontent-%COMP%]{font-size:20px}"]}),e}(),At=i("p+2o"),wt=[{path:"",component:yt,children:[{path:"",component:ht,canActivate:[At.a],data:{permissions:L.c.CAN_VIEW_USERS_LIST}},{path:"edit",component:Oe,canActivate:[At.a],data:{permissions:L.c.CAN_ADD_USER}},{path:"info/:id",component:R,canActivate:[At.a],data:{permissions:L.c.CAN_VIEW_USER_INFO}},{path:"roles",children:[{path:"",component:ae,canActivate:[At.a],data:{permissions:L.c.CAN_VIEW_ROLES_LIST}},{path:"edit",component:z,canActivate:[At.a],data:{permissions:L.c.CAN_ADD_ROLE}}]}]}],kt=function(){function e(){}return e.\u0275mod=l.Lb({type:e}),e.\u0275inj=l.Kb({factory:function(t){return new(t||e)},imports:[[d.i.forChild(wt)],d.i]}),e}(),It=i("iYTy"),Jt=i("Vm88"),Ot=function(){function e(){}return e.\u0275mod=l.Lb({type:e}),e.\u0275inj=l.Kb({factory:function(t){return new(t||e)},providers:[Q],imports:[[n.c,kt,F.s,Jt.a,F.g,It.a,K.b]]}),e}()}}]);